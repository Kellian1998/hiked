{% extends 'admin/adminbase.html.twig' %}

{% block body %}
    <div class="main-panel">
        <div class="content-wrapper">
            <!-- Page Title Header Starts-->
            <div class="row page-title-header">
                <div class="col-12">
                    <div class="page-header" style="display:flex;align-items:center;">
                        <h4 class="page-title">Newsletter</h4>
                        <div class="quick-link-wrapper w-100 d-md-flex flex-md-wrap"></div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 grid-margin stretch-card">
                    <div class="card">
                        <div class="card-body d-flex flex-column">
                            <div class="wrapper">
                            <h4 class="card-title mb-0">Les emails des personnes inscrites à la newsletter</h4>
                            <br>
                            <a href="{{ asset('csv/export_newsletter.csv') }}">
                                                    <button type="button" class="btn btn-danger btn-fw">
                                                        Exporter les emails abonnés en CSV
                                                        </button></a>
                      <div class="mb-4" id="net-profit-legend"></div>
                            </div>
                            <table class="table table-bordered">
                      <thead>
                        <tr>
                          <th> ID </th>
                          <th> Email </th>
                          <th> État </th>
                          <th> Actions </th>
                        </tr>
                      </thead>
                      <tbody>
                      {% for mail in mails %}

                        {% if mail.canceled == 1 %}
                        <tr class="table-danger">
                          <td> {{ mail.id }} </td>
                          <td> {{ mail.email }} </td>
                          <td> Désabonné </td>
                          <td> <a href="{{ path('delete_mail', { 'id': mail.id }) }}">
                                                    <button type="button" class="btn btn-danger btn-fw">
                                                        <span class="material-icons">
                                                            delete_outline
                                                        </span>
                                                        </button></a> </td>
                        </tr>
                        {% else %}
                        <tr class="table-success">
                          <td> {{ mail.id }} </td>
                          <td> {{ mail.email }} </td>
                          <td> Abonné </td>
                          <td> <a href="{{ path('delete_mail', { 'id': mail.id }) }}">
                                                    <button type="button" class="btn btn-danger btn-fw">
                                                        <span class="material-icons">
                                                            delete_outline
                                                        </span>
                                                        </button></a> </td>
                        </tr>
                        {% endif %}

                      {% endfor %}
                      </tbody>
                    </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endblock %}